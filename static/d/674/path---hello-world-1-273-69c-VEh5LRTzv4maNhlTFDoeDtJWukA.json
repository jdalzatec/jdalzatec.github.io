{"data":{"markdownRemark":{"html":"<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy\n<span class=\"token keyword\">from</span> matplotlib <span class=\"token keyword\">import</span> pyplot\n<span class=\"token keyword\">from</span> itertools <span class=\"token keyword\">import</span> product</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">length <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nJ <span class=\"token operator\">=</span> <span class=\"token number\">1.0</span>\nkB <span class=\"token operator\">=</span> <span class=\"token number\">1.0</span>\n\nN <span class=\"token operator\">=</span> length <span class=\"token operator\">*</span> length</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sites <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>product<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> repeat<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>sites<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>T\nfig <span class=\"token operator\">=</span> pyplot<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nax <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_subplot<span class=\"token punctuation\">(</span><span class=\"token number\">111</span><span class=\"token punctuation\">)</span>\nax<span class=\"token punctuation\">.</span>scatter<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\nax<span class=\"token punctuation\">.</span>set_aspect<span class=\"token punctuation\">(</span><span class=\"token string\">\"equal\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"output_3_0.png\" alt=\"png\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">random_config</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> numpy<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span>N<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">spins <span class=\"token operator\">=</span> random_config<span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">plot_state</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>sites<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>T\n    colors <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"k\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> N<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n    colors<span class=\"token punctuation\">[</span>spins <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"r\"</span>\n    \n    fig <span class=\"token operator\">=</span> pyplot<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    ax <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_subplot<span class=\"token punctuation\">(</span><span class=\"token number\">111</span><span class=\"token punctuation\">)</span>\n    ax<span class=\"token punctuation\">.</span>quiver<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> spins<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>colors<span class=\"token punctuation\">,</span>\n              pivot<span class=\"token operator\">=</span><span class=\"token string\">\"middle\"</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span>\n    ax<span class=\"token punctuation\">.</span>set_aspect<span class=\"token punctuation\">(</span><span class=\"token string\">\"equal\"</span><span class=\"token punctuation\">)</span>\n    pyplot<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plot_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"output_7_0.png\" alt=\"png\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">get_index</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">*</span> length <span class=\"token operator\">+</span> y</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">nhbs <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">for</span> x<span class=\"token punctuation\">,</span> y <span class=\"token keyword\">in</span> sites<span class=\"token punctuation\">:</span>\n    right <span class=\"token operator\">=</span> get_index<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> length<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\n    left <span class=\"token operator\">=</span> get_index<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> length<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\n    up <span class=\"token operator\">=</span> get_index<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> length<span class=\"token punctuation\">)</span>\n    down <span class=\"token operator\">=</span> get_index<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> length<span class=\"token punctuation\">)</span>\n    \n    nhbs<span class=\"token punctuation\">[</span>get_index<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>right<span class=\"token punctuation\">,</span> left<span class=\"token punctuation\">,</span> up<span class=\"token punctuation\">,</span> down<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">magnetization</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> spins<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">local_energy</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span> J <span class=\"token operator\">*</span> spins<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> spins<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>nhbs<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">total_energy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    energy <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span>\n    <span class=\"token keyword\">for</span> index <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        energy <span class=\"token operator\">+=</span> local_energy<span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0.5</span> <span class=\"token operator\">*</span> energy</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">metropolis</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    oldEnergy <span class=\"token operator\">=</span> local_energy<span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span>\n    spins<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">*=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n    newEnergy <span class=\"token operator\">=</span> local_energy<span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span>\n    deltaE <span class=\"token operator\">=</span> newEnergy <span class=\"token operator\">-</span> oldEnergy\n    <span class=\"token keyword\">if</span> deltaE <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token keyword\">and</span> numpy<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>uniform<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> numpy<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>deltaE<span class=\"token operator\">/</span><span class=\"token punctuation\">(</span>kB<span class=\"token operator\">*</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        spins<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">*=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">monte_carlo_step</span><span class=\"token punctuation\">(</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        index <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">)</span>\n        metropolis<span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">amount_mcs <span class=\"token operator\">=</span> <span class=\"token number\">500</span>\nT <span class=\"token operator\">=</span> <span class=\"token number\">0.001</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">temperature_step</span><span class=\"token punctuation\">(</span>amount_mcs<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    mags <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span>amount_mcs<span class=\"token punctuation\">)</span>\n    enes <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span>amount_mcs<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>amount_mcs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        monte_carlo_step<span class=\"token punctuation\">(</span>T<span class=\"token punctuation\">)</span>\n        mags<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> magnetization<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        enes<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> total_energy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> mags<span class=\"token punctuation\">,</span> enes</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>time\nspins <span class=\"token operator\">=</span> random_config<span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span>\nmags<span class=\"token punctuation\">,</span> enes <span class=\"token operator\">=</span> temperature_step<span class=\"token punctuation\">(</span>amount_mcs<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">CPU times: user 3.34 s, sys: 166 ms, total: 3.51 s\nWall time: 3.27 s</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pyplot<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>mags<span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"output_16_0.png\" alt=\"png\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pyplot<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>enes<span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"output_17_0.png\" alt=\"png\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plot_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"output_18_0.png\" alt=\"png\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">T_high <span class=\"token operator\">=</span> <span class=\"token number\">5.0</span>\nT_low <span class=\"token operator\">=</span> <span class=\"token number\">0.01</span>\npoints <span class=\"token operator\">=</span> <span class=\"token number\">101</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>time\ntemps <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span>T_high<span class=\"token punctuation\">,</span> T_low<span class=\"token punctuation\">,</span> points<span class=\"token punctuation\">)</span>\n\ndata_energies <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>temps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> amount_mcs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ndata_magnetizations <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>temps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> amount_mcs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nspins <span class=\"token operator\">=</span> random_config<span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> ind_T<span class=\"token punctuation\">,</span> T <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>temps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    mags<span class=\"token punctuation\">,</span> enes <span class=\"token operator\">=</span> temperature_step<span class=\"token punctuation\">(</span>amount_mcs<span class=\"token punctuation\">,</span> T<span class=\"token punctuation\">)</span>\n    data_energies<span class=\"token punctuation\">[</span>ind_T<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> enes\n    data_magnetizations<span class=\"token punctuation\">[</span>ind_T<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> mags\n    \n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span> ind_T <span class=\"token operator\">/</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>temps<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\" %\"</span> <span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">5.0\n4.9501\n4.9002\n4.8503\n4.8004\n4.7505\n4.7006\n4.6507\n4.6008\n4.5509\n4.501\n4.4511\n4.4012\n4.3513\n4.3014\n4.2515\n4.2016\n4.1517\n4.1018\n4.0519\n4.002\n3.9520999999999997\n3.9022\n3.8523\n3.8024\n3.7525\n3.7026\n3.6527000000000003\n3.6028000000000002\n3.5529\n3.503\n3.4531\n3.4032\n3.3533\n3.3034\n3.2535\n3.2036\n3.1536999999999997\n3.1038\n3.0539\n3.004\n2.9541\n2.9042\n2.8543\n2.8044000000000002\n2.7545\n2.7046\n2.6547\n2.6048\n2.5549\n2.505\n2.4551\n2.4052\n2.3553\n2.3054\n2.2555\n2.2056\n2.1557\n2.1058\n2.0559\n2.0060000000000002\n1.9561000000000002\n1.9062000000000001\n1.8563\n1.8064\n1.7565\n1.7066\n1.6566999999999998\n1.6067999999999998\n1.5569000000000002\n1.5070000000000001\n1.4571\n1.4072\n1.3573\n1.3074\n1.2574999999999998\n1.2076000000000002\n1.1577000000000002\n1.1078000000000001\n1.0579\n1.008\n0.9581\n0.9081999999999999\n0.8582999999999998\n0.8083999999999998\n0.7584999999999997\n0.7085999999999997\n0.6586999999999996\n0.6088000000000005\n0.5589000000000004\n0.5090000000000003\n0.4591000000000003\n0.40920000000000023\n0.3593000000000002\n0.3094000000000001\n0.25950000000000006\n0.2096\n0.15969999999999995\n0.1097999999999999\n0.05989999999999984\n0.01\nCPU times: user 5min 9s, sys: 12.5 s, total: 5min 21s\nWall time: 5min 4s</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plot_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"output_21_0.png\" alt=\"png\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">tau <span class=\"token operator\">=</span> amount_mcs <span class=\"token operator\">//</span> <span class=\"token number\">2</span>\nenergy_mean <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>data_energies<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> tau<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nmagnetization_mean <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">abs</span><span class=\"token punctuation\">(</span>numpy<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>data_magnetizations<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> tau<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pyplot<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>temps<span class=\"token punctuation\">,</span> energy_mean<span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">\"Energy\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">r\"$T$\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">r\"$\\left&lt;E\\right>$\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\npyplot<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>temps<span class=\"token punctuation\">,</span> magnetization_mean<span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">\"Magnetization\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">r\"$T$\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">r\"$\\left&lt;M\\right>$\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"output_23_0.png\" alt=\"png\"></p>\n<p><img src=\"output_23_1.png\" alt=\"png\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">energy_std <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>std<span class=\"token punctuation\">(</span>data_energies<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> tau<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nspecific_heat <span class=\"token operator\">=</span> energy_std <span class=\"token operator\">**</span> <span class=\"token number\">2</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>kB <span class=\"token operator\">*</span> temps <span class=\"token operator\">*</span> temps<span class=\"token punctuation\">)</span>\n\npyplot<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>temps<span class=\"token punctuation\">,</span> specific_heat<span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">\"Specific heat\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">r\"$T$\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">r\"$C_v$\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"output_24_0.png\" alt=\"png\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">magnetization_std <span class=\"token operator\">=</span> numpy<span class=\"token punctuation\">.</span>std<span class=\"token punctuation\">(</span>numpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">abs</span><span class=\"token punctuation\">(</span>data_magnetizations<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> tau<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nsusceptibility <span class=\"token operator\">=</span> magnetization_std <span class=\"token operator\">**</span> <span class=\"token number\">2</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>kB <span class=\"token operator\">*</span> temps<span class=\"token punctuation\">)</span>\n\npyplot<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>temps<span class=\"token punctuation\">,</span> susceptibility<span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">\"Susceptibility\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">r\"$T$\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">r\"$\\chi$\"</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npyplot<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"output_25_0.png\" alt=\"png\"></p>","frontmatter":{"date":"April 14, 2019","path":"/hello-world1","title":"My first gatsby post"}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}